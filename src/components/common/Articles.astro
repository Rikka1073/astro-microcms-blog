---
import Filter from "../react/Filter";
import ArticlesList from "../react/ArticlesList";

type Categories = {
  name: string;
  tags: string;
};

const accessToken = import.meta.env.QIITA_API_ACCESS_TOKEN;
const response = await fetch(`https://qiita.com/api/v2/authenticated_user/items?page=1&per_page=20`, {
  headers: {
    Authorization: `Bearer ${accessToken}`,
  },
});
const articles = await response.json();
// console.log("記事データ", articles);

const articlesWithTagIds = articles.map((article) => ({
  ...article,
  tags: article.tags.map((tag) => ({
    ...tag,
    id: crypto.randomUUID(),
  })),
}));

const categories = [...new Set(articles.flatMap((article: Categories) => article.tags).map((tag: Categories) => tag.name))];
console.log("カテゴリ", categories);
---

<ArticlesList articles={articlesWithTagIds} categories={categories} client:load />
